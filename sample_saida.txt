Instanciando QueryRunner para a url oracle.decom.cefetmg.br na porta 1521
Iniciando conexão ao banco de dados
Executando a query (10 vezes): (select est.NOME as ESTADO, '---TOTAL---' as CIDADE, CONT.NUMERO as CONTAGEM from ESTADO est join (select c.ESTADO as ESTADO, count(distinct al.MATRICULA) as NUMERO from CIDADE c left join ALUNO al on c.ID = al.ID_CIDADE where al.MATRICULA is null or al.DATA_NASC >= TO_DATE('01/01/1950', 'dd/mm/yyyy') group by c.ESTADO) CONT  on cont.ESTADO = est.ID)  UNION (select est.NOME as ESTADO, cid.NOME as CIDADE, CONT.NUMERO as CONTAGEM from CIDADE cid join (select c.ID as CIDADE, count(distinct al.MATRICULA) as NUMERO from CIDADE c join ALUNO al on c.ID = al.ID_CIDADE where al.DATA_NASC >= TO_DATE('01/01/1950', 'dd/mm/yyyy') group by c.ID) CONT on cont.CIDADE = cid.ID join ESTADO est on cid.ESTADO = est.ID) order by ESTADO, CIDADE asc
Executando a query (10 vezes): select al.NOME as NOME, al.CPF as CPF, hist.CONTAGEM as "NÚMERO DE TURMAS", coalesce(ROUND(hist.MEDIA_NOTA, 2),0) as "MÉDIA DE NOTAS", coalesce(ROUND(hist.MEDIA_FALTAS,2),0) as "MÉDIA DE FALTAS", case when hist.MEDIA_NOTA < 60 or hist.MEDIA_FALTAS > 10 then 'REPROVADO' else 'APROVADO' end as SITUACAO from ALUNO al left join (select alu.MATRICULA as MATRICULA, count(alu.MATRICULA) as CONTAGEM, avg(bol.NOTA) as MEDIA_NOTA, avg(bol.FALTAS) as MEDIA_FALTAS from ALUNO alu join BOLETIM bol on alu.MATRICULA = bol.MATRICULA_ALUNO group by alu.MATRICULA) hist on al.MATRICULA = hist.MATRICULA where al.DATA_MATRICULA >= TO_DATE('01/01/2000', 'dd/mm/yyyy') order by al.NOME
Executando a query (10 vezes): select cur.NOME as CURSO, coalesce(hist.CONTAGEM, 0) as "NÚMERO DE ALUNOS", coalesce(hist.MAXIMO_NOTA, 0) as "NOTA MÁXIMA",coalesce(ROUND(hist.MEDIA_NOTA, 2), 0) as "MÉDIA DE NOTAS", coalesce(ROUND(hist.MEDIA_FALTAS, 2),0) as "MÉDIA DE FALTAS" from CURSO cur left join (select subCur.ID as ID_CURSO, count(distinct alu.MATRICULA) as CONTAGEM, avg(bol.NOTA) as MEDIA_NOTA, avg(bol.FALTAS) as MEDIA_FALTAS, max(bol.NOTA) as MAXIMO_NOTA from ALUNO alu join BOLETIM bol on alu.MATRICULA = bol.MATRICULA_ALUNO join TURMA tur on bol.ID_TURMA = tur.ID join CURSO subCur on tur.ID_CURSO = subCur.ID where alu.DATA_MATRICULA >= TO_DATE('01/01/2000', 'dd/mm/yyyy') group by subCur.ID) hist on cur.ID = hist.ID_CURSO order by cur.NOME asc
Executando a query (10 vezes): select cur.NOME as CURSO, coalesce(hist.MAXIMO_NOTA, 0) as "NOTA MÁXIMA", coalesce(hist_aluno.NOME, '-') as ALUNO from CURSO cur left join (select subCur.ID as ID_CURSO, max(bol.NOTA) as MAXIMO_NOTA from ALUNO alu join BOLETIM bol on alu.MATRICULA = bol.MATRICULA_ALUNO join TURMA tur on bol.ID_TURMA = tur.ID join CURSO subCur on tur.ID_CURSO = subCur.ID where alu.DATA_MATRICULA >= TO_DATE('01/01/2000', 'dd/mm/yyyy') group by subCur.ID) hist on cur.ID = hist.ID_CURSO  left join (select tur.ID_CURSO as ID_CURSO, alu.MATRICULA as ID_ALUNO, alu.NOME as NOME, max(bol.NOTA) as MAXIMO_NOTA from ALUNO alu join BOLETIM bol on alu.MATRICULA = bol.MATRICULA_ALUNO join TURMA tur on bol.ID_TURMA = tur.ID where alu.DATA_MATRICULA >= TO_DATE('01/01/2000', 'dd/mm/yyyy') group by tur.ID_CURSO, alu.MATRICULA, alu.NOME) hist_aluno on cur.ID = hist_aluno.ID_CURSO and hist.MAXIMO_NOTA = hist_aluno.MAXIMO_NOTA order by cur.NOME asc
Executando a query (10 vezes): select SUBSTR(al.NOME, 1, 1) as INICIAL, count(distinct al.MATRICULA) as CONTAGEM, coalesce(ROUND(avg(bol.NOTA),2),0) as "NOTA MÉDIA", coalesce(ROUND(avg(bol.FALTAS),2),0) as "MÉDIA DE FALTAS", coalesce(ROUND(max(bol.NOTA),2),0) as "NOTA MÁXIMA"  from ALUNO al left join BOLETIM bol on al.MATRICULA = bol.MATRICULA_ALUNO where al.DATA_MATRICULA >= TO_DATE('01/01/2000', 'dd/mm/yyyy') group by SUBSTR(al.NOME, 1, 1) order by INICIAL asc
Executando a query (10 vezes): select al.NOME as ALUNO, al.CPF, coalesce(datas.SEMESTRE, '-') as "SEMESTRE CORRENTE", coalesce(count(distinct tur.ID),0) as "NÚMERO DE TURMAS", coalesce(ROUND(avg(bol.NOTA),2),0) as "NOTA MÉDIA", coalesce(ROUND(avg(bol.FALTAS),2),0) as "MÉDIA DE FALTAS", coalesce(max(bol.NOTA),0) as "NOTA MÁXIMA" from ALUNO al left join BOLETIM bol on al.MATRICULA = bol.MATRICULA_ALUNO left join TURMA tur on bol.ID_TURMA = tur.ID left join (select (TO_CHAR(extract(year from DATA_INICIO)) || (case when IMPAR = 0 then '/1' else '/2' end)) as SEMESTRE, DATA_INICIO, DATA_FIM from  (select IMPAR, TO_DATE('01/' || (case when IMPAR = 0 then '01' else '06' end) || '/' || TO_CHAR(1999 + n), 'dd/mm/yyyy') as DATA_INICIO, TO_DATE((case when IMPAR = 0 then '30' else '31' end) || '/' || (case when IMPAR = 0 then '05' else '12' end) || '/' || TO_CHAR(1999 + n), 'dd/mm/yyyy') as DATA_FIM from(select floor((rownum - 1) / 2) as n, mod(rownum - 1, 2) as IMPAR from dual connect by level <= (extract(year from sysdate) - 1999 + 1) * 2))) datas on (tur.DATA_INICIO >= datas.DATA_INICIO and tur.DATA_INICIO <= datas.DATA_FIM) or ((tur.DATA_FIM is null and tur.DATA_INICIO <= datas.DATA_FIM) or (tur.DATA_FIM >= datas.DATA_INICIO and tur.DATA_FIM <= datas.DATA_FIM)) where al.NOME not like 'Craig%' or al.CPF = '550.296.575-92' group by al.NOME, al.CPF, coalesce(datas.SEMESTRE, '-') order by ALUNO, "SEMESTRE CORRENTE" asc
Executando a query (10 vezes): select al.NOME as ALUNO, al.CPF, coalesce(datas.SEMESTRE, '-') as "SEMESTRE CORRENTE", coalesce(count(distinct tur.ID),0) as "NÚMERO DE TURMAS", coalesce(ROUND(avg(bol.NOTA),2),0) as "NOTA MÉDIA", coalesce(ROUND(avg(bol.FALTAS),2),0) as "MÉDIA DE FALTAS", coalesce(max(bol.NOTA),0) as "NOTA MÁXIMA" from ALUNO al left join BOLETIM bol on al.MATRICULA = bol.MATRICULA_ALUNO left join TURMA tur on bol.ID_TURMA = tur.ID left join (select (TO_CHAR(extract(year from DATA_INICIO)) || (case when IMPAR = 0 then '/1' else '/2' end)) as SEMESTRE, DATA_INICIO, DATA_FIM from  (select IMPAR, TO_DATE('01/' || (case when IMPAR = 0 then '01' else '06' end) || '/' || TO_CHAR(1999 + n), 'dd/mm/yyyy') as DATA_INICIO, TO_DATE((case when IMPAR = 0 then '30' else '31' end) || '/' || (case when IMPAR = 0 then '05' else '12' end) || '/' || TO_CHAR(1999 + n), 'dd/mm/yyyy') as DATA_FIM from(select floor((rownum - 1) / 2) as n, mod(rownum - 1, 2) as IMPAR from dual connect by level <= (extract(year from sysdate) - 1999 + 1) * 2))) datas on (tur.DATA_INICIO >= datas.DATA_INICIO and tur.DATA_INICIO <= datas.DATA_FIM) or ((tur.DATA_FIM is null and tur.DATA_INICIO <= datas.DATA_FIM) or (tur.DATA_FIM >= datas.DATA_INICIO and tur.DATA_FIM <= datas.DATA_FIM)) where al.DATA_MATRICULA >= TO_DATE('01/01/2005', 'dd/mm/yyyy') group by al.NOME, al.CPF, coalesce(datas.SEMESTRE, '-') order by ALUNO, "SEMESTRE CORRENTE" asc

---------------------------------------------
Query: (select est.NOME as ESTADO, '---TOTAL---' as CIDADE, CONT.NUMERO as CONTAGEM from ESTADO est join (select c.ESTADO as ESTADO, count(distinct al.MATRICULA) as NUMERO from CIDADE c left join ALUNO al on c.ID = al.ID_CIDADE where al.MATRICULA is null or al.DATA_NASC >= TO_DATE('01/01/1950', 'dd/mm/yyyy') group by c.ESTADO) CONT  on cont.ESTADO = est.ID)  UNION (select est.NOME as ESTADO, cid.NOME as CIDADE, CONT.NUMERO as CONTAGEM from CIDADE cid join (select c.ID as CIDADE, count(distinct al.MATRICULA) as NUMERO from CIDADE c join ALUNO al on c.ID = al.ID_CIDADE where al.DATA_NASC >= TO_DATE('01/01/1950', 'dd/mm/yyyy') group by c.ID) CONT on cont.CIDADE = cid.ID join ESTADO est on cid.ESTADO = est.ID) order by ESTADO, CIDADE asc
Número de execuções: 10
Número de linhas obtidas: 541
Tempo médio das execuções: 0.05000 segundos
---------------------------------------------

---------------------------------------------
Query: select al.NOME as NOME, al.CPF as CPF, hist.CONTAGEM as "NÚMERO DE TURMAS", coalesce(ROUND(hist.MEDIA_NOTA, 2),0) as "MÉDIA DE NOTAS", coalesce(ROUND(hist.MEDIA_FALTAS,2),0) as "MÉDIA DE FALTAS", case when hist.MEDIA_NOTA < 60 or hist.MEDIA_FALTAS > 10 then 'REPROVADO' else 'APROVADO' end as SITUACAO from ALUNO al left join (select alu.MATRICULA as MATRICULA, count(alu.MATRICULA) as CONTAGEM, avg(bol.NOTA) as MEDIA_NOTA, avg(bol.FALTAS) as MEDIA_FALTAS from ALUNO alu join BOLETIM bol on alu.MATRICULA = bol.MATRICULA_ALUNO group by alu.MATRICULA) hist on al.MATRICULA = hist.MATRICULA where al.DATA_MATRICULA >= TO_DATE('01/01/2000', 'dd/mm/yyyy') order by al.NOME
Número de execuções: 10
Número de linhas obtidas: 794
Tempo médio das execuções: 0.06100 segundos
---------------------------------------------

---------------------------------------------
Query: select cur.NOME as CURSO, coalesce(hist.CONTAGEM, 0) as "NÚMERO DE ALUNOS", coalesce(hist.MAXIMO_NOTA, 0) as "NOTA MÁXIMA",coalesce(ROUND(hist.MEDIA_NOTA, 2), 0) as "MÉDIA DE NOTAS", coalesce(ROUND(hist.MEDIA_FALTAS, 2),0) as "MÉDIA DE FALTAS" from CURSO cur left join (select subCur.ID as ID_CURSO, count(distinct alu.MATRICULA) as CONTAGEM, avg(bol.NOTA) as MEDIA_NOTA, avg(bol.FALTAS) as MEDIA_FALTAS, max(bol.NOTA) as MAXIMO_NOTA from ALUNO alu join BOLETIM bol on alu.MATRICULA = bol.MATRICULA_ALUNO join TURMA tur on bol.ID_TURMA = tur.ID join CURSO subCur on tur.ID_CURSO = subCur.ID where alu.DATA_MATRICULA >= TO_DATE('01/01/2000', 'dd/mm/yyyy') group by subCur.ID) hist on cur.ID = hist.ID_CURSO order by cur.NOME asc
Número de execuções: 10
Número de linhas obtidas: 223
Tempo médio das execuções: 0.03900 segundos
---------------------------------------------

---------------------------------------------
Query: select cur.NOME as CURSO, coalesce(hist.MAXIMO_NOTA, 0) as "NOTA MÁXIMA", coalesce(hist_aluno.NOME, '-') as ALUNO from CURSO cur left join (select subCur.ID as ID_CURSO, max(bol.NOTA) as MAXIMO_NOTA from ALUNO alu join BOLETIM bol on alu.MATRICULA = bol.MATRICULA_ALUNO join TURMA tur on bol.ID_TURMA = tur.ID join CURSO subCur on tur.ID_CURSO = subCur.ID where alu.DATA_MATRICULA >= TO_DATE('01/01/2000', 'dd/mm/yyyy') group by subCur.ID) hist on cur.ID = hist.ID_CURSO  left join (select tur.ID_CURSO as ID_CURSO, alu.MATRICULA as ID_ALUNO, alu.NOME as NOME, max(bol.NOTA) as MAXIMO_NOTA from ALUNO alu join BOLETIM bol on alu.MATRICULA = bol.MATRICULA_ALUNO join TURMA tur on bol.ID_TURMA = tur.ID where alu.DATA_MATRICULA >= TO_DATE('01/01/2000', 'dd/mm/yyyy') group by tur.ID_CURSO, alu.MATRICULA, alu.NOME) hist_aluno on cur.ID = hist_aluno.ID_CURSO and hist.MAXIMO_NOTA = hist_aluno.MAXIMO_NOTA order by cur.NOME asc
Número de execuções: 10
Número de linhas obtidas: 259
Tempo médio das execuções: 0.03700 segundos
---------------------------------------------

---------------------------------------------
Query: select SUBSTR(al.NOME, 1, 1) as INICIAL, count(distinct al.MATRICULA) as CONTAGEM, coalesce(ROUND(avg(bol.NOTA),2),0) as "NOTA MÉDIA", coalesce(ROUND(avg(bol.FALTAS),2),0) as "MÉDIA DE FALTAS", coalesce(ROUND(max(bol.NOTA),2),0) as "NOTA MÁXIMA"  from ALUNO al left join BOLETIM bol on al.MATRICULA = bol.MATRICULA_ALUNO where al.DATA_MATRICULA >= TO_DATE('01/01/2000', 'dd/mm/yyyy') group by SUBSTR(al.NOME, 1, 1) order by INICIAL asc
Número de execuções: 10
Número de linhas obtidas: 25
Tempo médio das execuções: 0.02600 segundos
---------------------------------------------

---------------------------------------------
Query: select al.NOME as ALUNO, al.CPF, coalesce(datas.SEMESTRE, '-') as "SEMESTRE CORRENTE", coalesce(count(distinct tur.ID),0) as "NÚMERO DE TURMAS", coalesce(ROUND(avg(bol.NOTA),2),0) as "NOTA MÉDIA", coalesce(ROUND(avg(bol.FALTAS),2),0) as "MÉDIA DE FALTAS", coalesce(max(bol.NOTA),0) as "NOTA MÁXIMA" from ALUNO al left join BOLETIM bol on al.MATRICULA = bol.MATRICULA_ALUNO left join TURMA tur on bol.ID_TURMA = tur.ID left join (select (TO_CHAR(extract(year from DATA_INICIO)) || (case when IMPAR = 0 then '/1' else '/2' end)) as SEMESTRE, DATA_INICIO, DATA_FIM from  (select IMPAR, TO_DATE('01/' || (case when IMPAR = 0 then '01' else '06' end) || '/' || TO_CHAR(1999 + n), 'dd/mm/yyyy') as DATA_INICIO, TO_DATE((case when IMPAR = 0 then '30' else '31' end) || '/' || (case when IMPAR = 0 then '05' else '12' end) || '/' || TO_CHAR(1999 + n), 'dd/mm/yyyy') as DATA_FIM from(select floor((rownum - 1) / 2) as n, mod(rownum - 1, 2) as IMPAR from dual connect by level <= (extract(year from sysdate) - 1999 + 1) * 2))) datas on (tur.DATA_INICIO >= datas.DATA_INICIO and tur.DATA_INICIO <= datas.DATA_FIM) or ((tur.DATA_FIM is null and tur.DATA_INICIO <= datas.DATA_FIM) or (tur.DATA_FIM >= datas.DATA_INICIO and tur.DATA_FIM <= datas.DATA_FIM)) where al.NOME not like 'Craig%' or al.CPF = '550.296.575-92' group by al.NOME, al.CPF, coalesce(datas.SEMESTRE, '-') order by ALUNO, "SEMESTRE CORRENTE" asc
Número de execuções: 10
Número de linhas obtidas: 5799
Tempo médio das execuções: 1.24300 segundos
---------------------------------------------

---------------------------------------------
Query: select al.NOME as ALUNO, al.CPF, coalesce(datas.SEMESTRE, '-') as "SEMESTRE CORRENTE", coalesce(count(distinct tur.ID),0) as "NÚMERO DE TURMAS", coalesce(ROUND(avg(bol.NOTA),2),0) as "NOTA MÉDIA", coalesce(ROUND(avg(bol.FALTAS),2),0) as "MÉDIA DE FALTAS", coalesce(max(bol.NOTA),0) as "NOTA MÁXIMA" from ALUNO al left join BOLETIM bol on al.MATRICULA = bol.MATRICULA_ALUNO left join TURMA tur on bol.ID_TURMA = tur.ID left join (select (TO_CHAR(extract(year from DATA_INICIO)) || (case when IMPAR = 0 then '/1' else '/2' end)) as SEMESTRE, DATA_INICIO, DATA_FIM from  (select IMPAR, TO_DATE('01/' || (case when IMPAR = 0 then '01' else '06' end) || '/' || TO_CHAR(1999 + n), 'dd/mm/yyyy') as DATA_INICIO, TO_DATE((case when IMPAR = 0 then '30' else '31' end) || '/' || (case when IMPAR = 0 then '05' else '12' end) || '/' || TO_CHAR(1999 + n), 'dd/mm/yyyy') as DATA_FIM from(select floor((rownum - 1) / 2) as n, mod(rownum - 1, 2) as IMPAR from dual connect by level <= (extract(year from sysdate) - 1999 + 1) * 2))) datas on (tur.DATA_INICIO >= datas.DATA_INICIO and tur.DATA_INICIO <= datas.DATA_FIM) or ((tur.DATA_FIM is null and tur.DATA_INICIO <= datas.DATA_FIM) or (tur.DATA_FIM >= datas.DATA_INICIO and tur.DATA_FIM <= datas.DATA_FIM)) where al.DATA_MATRICULA >= TO_DATE('01/01/2005', 'dd/mm/yyyy') group by al.NOME, al.CPF, coalesce(datas.SEMESTRE, '-') order by ALUNO, "SEMESTRE CORRENTE" asc
Número de execuções: 10
Número de linhas obtidas: 4220
Tempo médio das execuções: 0.90900 segundos
---------------------------------------------
Desconectando do banco de dados

